{"data":{"site":{"siteMetadata":{"title":"Dev Blog","author":"Arek Jurasz"}},"markdownRemark":{"id":"b6b02fb3-76fe-51e5-853a-9ac1ad9ea4ee","html":"<p>Over the weekend I decided to once and for all resolve issue with boiling water in our central heating system. For people who don’t know what I’m writing about here, you will find nice <a href=\"https://www.plumber24hours.co.uk/plumber-blog/index.php/2013/01/05/solid-fuel/\">ilustration</a> that should make it clear. In my case the problem is that when I focus on something I forgot about the world around me and then after some time the sound of boiling water in pipes immediately pulls me out of my work and in few seconds I’m in the basement trying to resolve issue in different ways and this isn’t a pleasant operation. Please notice that this situation is very dangerous because boiling water can damage pipes and in few minutes your home can be flooded and repair costs probably will be very high.\nSolution to my issue would be replacing the old furnace with new one that can automatically take care of temperature adjustments, but I have got much more cheaper and more interensting solution for this one. </p>\n<!-- end -->\n<h2>Idea</h2>\n<p>My idea is to use <a href=\"https://en.wikipedia.org/wiki/ESP8266\">ESP8266</a> that will send temperature readings to <a href=\"https://www.cloudmqtt.com/\">MQTT broker</a> running in the cloud\nand then business logic will be handled by lightweight nodejs application running on <a href=\"https://dashboard.heroku.com/\">Heroku</a>. Logic is simple, display the current temperature in real time one web page using WebSocket protocol, expose REST endpoint with current temperature and send a notification to registered Android devices when the temperature is over 80 Celcius degrees. Registered devices will be stored in MongoDB hosted by <a href=\"https://mlab.com/\">mLab</a>. Here is top level architecture diagram:</p>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin: 15px -30px !important max-width: 690px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 48.55072463768116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACj0lEQVQoz2NgLF/Bwvz/PxNj2wEWxtJyBhhQv3OBRWxuDwdDsi8Lw7QOFoZ4Txbh6c0csjPqWUDyTCntTIy5s3gZE7uFGJN7hRiLFvIx5s1hZmBMn8TPYOojyRhSys+Yv0yQQa+ZjdtYl0fU11MIpPHOs+dNd548OXPz2YsuBtlpbPxxVSKsjAyCDGFLpJh6T/ADlQgAMTdj+0EuoIGyDIwhFZwM/KIKDHKK3IzZq8UYzFqFOOQlpLjlZGWBChnPv32/98Lbt/8PXrl5i0F9DQ+bW4w4CyeHDAOXiDSDhrkCY+hkCcacZYKMhXN4GPPnszIw5c3iZQqeJ8WUt4yPqXw2O8hVOv9/MgcAgwHEPvbju8bRL1+cbj1/aeVrMJWJr7Gai9/IAORtZpC8sE6YnLienQA8rCKBWIidSVqUgYEFJibWVs8uVFPKyoAFSM/o57D4/x9ZiAvB9GdgYHWYy86gOcGUwXgyH0xYYlIXq+Tkbk6RjgbW6FcP2Xb9/8+ScPIwu2RPK5vE5G4e2eZ6xlsPfjGC1M7adGTJrI0Hc0HsmRsPMTFM2XpbYNmhxzMXH3miCBJccPgRWKF4VxOr4rHdLBwmhgIsstKyPB4u3HKbVrACxVmqVAIZ/v//D1Z34+2X15eev18AZbMwfP7/X+rG/cf/Lz96bQMWfPmZSby5BtlLoHAVhIUZCNglFsANXH/0ws7VB87UgtjrDp5kZvgINPDizbv/z9x5ZgsSvPzkA5PUvGkMiif3MXA72aGEH2+AN4PswW3owcoNxJz//28GRyLD1Te/hG6/+rz93JPP2iD+2adfGLFFhomJCZhOSUlhA2Le5NQ0nqyECO6cWQe4jBoPSq2YXihXGefBDgACGNmIV03LbgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"esp8266_remote_temperature_diagram\"\n        title=\"\"\n        src=\"/static/esp8266_remote_temperature_diagram-5e5d7d080fb98fe2e4801751713735c5-80db2.png\"\n        srcset=\"/static/esp8266_remote_temperature_diagram-5e5d7d080fb98fe2e4801751713735c5-24d5e.png 175w,\n/static/esp8266_remote_temperature_diagram-5e5d7d080fb98fe2e4801751713735c5-99a10.png 350w,\n/static/esp8266_remote_temperature_diagram-5e5d7d080fb98fe2e4801751713735c5-80db2.png 690w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n      />\n    </span>\n  </span>\n  </p>\n<h2>Costs</h2>\n<p>Only costs I had to bear were for physical devices:</p>\n<ul>\n<li>ESP8266 bought <a href=\"http://allegro.pl/modul-sieciowy-wifi-esp8266-sterowanie-rs232-at-i5506834559.html\">here</a> for about 4$</li>\n<li>Converter USB UART/RS232 bought <a href=\"http://allegro.pl/konwerter-przejsciowka-usb-uart-rs232-pl2303hx-avr-i5734968614.html\">here</a> for about 1$</li>\n<li>DS18B20 digital temperature sensor bought <a href=\"http://allegro.pl/czujnik-temperatury-ds18b20-wodoodprony-przewod-1m-i5460123942.html\">here</a> for about 1,8 $</li>\n<li>Power supply bought <a href=\"http://allegro.pl/ladowarka-zasilacz-usb-5v-2a-kabel-mikrousb-i5903646901.html\">here</a> 4$</li>\n</ul>\n<p>Total: 10,8 $</p>\n<p>If it comes to MQTT broker, application and database hosting I’m using free plans as they are sufficient for my needs.</p>\n<h2>Implementation</h2>\n<p>Complete project can be found on <a href=\"https://github.com/ajurasz/RemoteTemperature\">github</a>. In this post, I will only focus on core parts of each component. So what are the components:</p>\n<ul>\n<li>ESP8226 device</li>\n<li>Nodejs application </li>\n<li>Android application</li>\n</ul>\n<p>Regarding <a href=\"https://iot.eclipse.org/resources/white-papers/Eclipse%20IoT%20White%20Paper%20-%20The%20Three%20Software%20Stacks%20Required%20for%20IoT%20Architectures.pdf\">Eclipse IoT White Paper</a> I would say that in my simple architecture ESP8266 act as both field device and gateway. Nodejs is an application that only performs business logic on data delivered by devices (in my case just one device). Android application is for the end user, where that user can check current temperature and be notified when the temperature is too high. </p>\n<h3>ESP8226</h3>\n<p>If it comes to ESP8266 there are two main things that you need to know when playing with this device. There are different wirings for deploying and running your program. When you want to deploy your program to the device you need to set up wirings in following way:</p>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin: 15px -30px !important max-width: 700px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.89066918001885%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACN0lEQVQoz32STWsTURSGZ+s/0I3uXLhSFMS9iFBx0YVYNxYEtUJBKGk3orhwVQUFNy4VlLZoG9NvmzRJk04mycxk8lGT2rQWirU0k6aaNOlHZh4nY5pGCz3wcuCee59zeM8VqoZBtWpgh2mwtJglEddQ5KidY6pCMhlH19ftK4Z13zBNW2ZT3pdAPQwT9N/bRLQ5AmEVjz9EQFLxizLT4QhJq9FRYTeyJMzEVixIlkHfPOnsGqFZGfe0yKRXxGtljzuI1z/LbGqJ4h7kCgXW8wXyW9sUyxXyv4qUd3YbYOHU5W6OnW7lfEsHaaeL+Rk/UZ+bQNCSc5CZoSG8zn5cAx959fodJ290cqLNwdmbHZy73cXx9iecaevk+rUWHI5uhJdvx3n0fIBbPT0kMl9RNY33A30MT4zg9nkZm/zChH+KzMICfZ4AF7ufceXxG1rb73LpjoMLXS+4+vApD+7fo7e398DDKc2DL+jn8ycn/R/6EAMic4kkmhIjFlfJb+gUKfFj62fdc7O+SPMfL4VqtWodWt7sbpAtfSeQFm24KzTCaHic4dAYrugo0nKUucI3NrYLfzkcgGrbrXFqEvbXXauXdyrEUwkiSoRgKEhUiSJFJEJqiMXVpcbjoyTUOpn1sQ3rP2bSGbSYRlgKo6kxlKiCrMmsrK00gM3g/5sIzYU9a+RUKoUsy4iiaH1u2QZLisTy6vIhYHNuePh/cXNzk1wuZyufz9tZ13XK5fIhQPO7SqVCqVTiD2QzC3rQ67XmAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"ESP8266_upload\"\n        title=\"\"\n        src=\"/static/ESP8266_upload-25249e1fdd8758c1dcd6545a8021fe83-bc3ba.png\"\n        srcset=\"/static/ESP8266_upload-25249e1fdd8758c1dcd6545a8021fe83-367a5.png 175w,\n/static/ESP8266_upload-25249e1fdd8758c1dcd6545a8021fe83-cfecb.png 350w,\n/static/ESP8266_upload-25249e1fdd8758c1dcd6545a8021fe83-bc3ba.png 700w,\n/static/ESP8266_upload-25249e1fdd8758c1dcd6545a8021fe83-1b41b.png 1050w,\n/static/ESP8266_upload-25249e1fdd8758c1dcd6545a8021fe83-d48fe.png 1061w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>when you want to run your program, wirings should be set up in the following way (scheme contains temperature sensor connected to ESP8266):</p>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin: 15px -30px !important max-width: 254px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 177.55905511811022%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFKElEQVRIx6WWC0yTVxTHvxlJ5jbMtgyK4txi1BCRMJ0axSDoptMtgsNA6GDKHB1DNAsCFXRE3uImVQSsQEUt47GBYCkSdDrUKkMEx0AYUoE6kJdM2sqj9PXf/T7aCTIQ6m1OvpMvp7/+z73n3FMKEyy9Xg+dTsf4EokEXC4X4eHhSExMhEaj+S/m+UVNBjR+kcfjgaIomJmZwc7ODmq1+uWAfD4f5ubmsLa2hpOT0/SBdOBoYFJyMmbNmgVLS0s4ODhANTw8Jm5KCumlVo8ABWmpDJDFYmGdoyONMk0h9DrQyR2IioP566/BiihcvmIlmtq7pqeQSVc7csIFN6thw94L1lYOLIjNc+VgX5LQGDh9YObV23jVbR/mfBUJK59DMPcMhXtcuukKc8oqMcczCHN3HISl9wFYsUPASTjzEsBrlZjvFQwLrzC8Q8ySzcWuoxmmALWMf5akTG3ZgyUBh7HAN5JJ3yU6zXSFuUThXJLyMv9ILNjGwcwPN8M1OMYQp5s6UGsAlpRXwzUwAgvYgVjkHYz3vLlgx5mg0AgsulkF593fY9V2HzhtccEq543wC4swPWUhXTbbg2Cz2hlr7G2xzNYGOznfTj9lI/AcAc5w+Q727ACs9/aDg8cu+EYmmK7w3G+VMHMLwmrucdgHJsAmIB7uR86OAxr9F5fNJQlmbNyFxX4xeNcnHNakwANP5Y0D0pcxbRMDNSNAQU4+KOslsPo6GiyvULzN3g/fxKwxwNFpv1DhadFlzHT4HAv9YhmFLNJ+HvEZo6phJC4rKwsRkRFTOZRKzP4iDA77eXDkHoNdQBzcYgXjgLwEHji+nBcrTL9SCYtPdmKTx3Z8tIMDJw8OXKP4Y1Mmn9rGOjRIGyYG6gz70qYYQElBCXjf7Aaf7GdR2S3cbmxhbm2jOsWTx0grKcXFX0STjwDjGEV3Jy4eiUevvO9/44aUfUjKKUVJqmjyEaAnQFqnqrUVuWQmpwgEEBeJUVBYCJFIxJhYXIy87Ezw839F6ZliUPTmjzWtwYhvGFJqmQwFUVGoaWiAamgIcrkcSqWSMblCgeF+BR4oARH//OQpGxetsDAmGi3t7RPGtPYbgIdPX0Os4Bpi0q8zzx/Jy/i0UsQIJIg6VYbOp0RlVwdRGI0motS4t8ZtGdlnHVqe0kDSBLNXhYBaGAZqETFbctVbsGD2/lbYuh7Fyg3+kJwSoiNXiOy4Q2hufzShQtkguepSC0FtYIeR2gqB594f8PHOeLy1aDPeXLEHTt7H4fLlQdyt+BPyinLkhIWivr4e+oEBDPb1YYic+LCyH4NyJfSKJ2jsHER+ghDUJtKbnr5B+GBbBOY6BmP5GmfM++w4Fvskw5Fc+eWJfHTkZCM7NBQ3Tp5EFzlZWX4e2gouoCEjBdKss+i+UABJlhjnT+SAWvppCNa6BWP+ei5eWRqIOWsD8Mb6Y5i3zg9r3SPQ2q1iUqqurcV9qXRMms13iqDoamJ8aY8KVbIBUJfLm0Hb1QopblY1Q3hJihTxAySn/Ywd/oeQX1iM62VlSEkmappGgBrDv686SRF6Hv7F+A1/K3Crvnd82fSrtMj/vQuXa7qReakW6eK7OFlYhfTiGojvkI6524Pi6m6U/NGL87eaybtHuFLXh59udOCeTAmKHkajjS6DQZUGyiEthklFqEmr0OVNP+kfezqkYZ6K/mF09SrQ1vkY3f8o0NnzBCqV6plC/ai2G9WEz9mzpdWo8VDWigfSJtTfq0PT/UbU1NTgX/I2rwVA5LL8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"ESP8266_run\"\n        title=\"\"\n        src=\"/static/ESP8266_run-85801ae33ce503d5e02cee5724711ac0-f8c1e.png\"\n        srcset=\"/static/ESP8266_run-85801ae33ce503d5e02cee5724711ac0-addb9.png 175w,\n/static/ESP8266_run-85801ae33ce503d5e02cee5724711ac0-f8c1e.png 254w\"\n        sizes=\"(max-width: 254px) 100vw, 254px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>Main responsibilities of ESP8226 device are:</p>\n<ol>\n<li>establish and keep a connection to local network (to gain access to the internet) </li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;ESP8266WiFi.h></span></span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> wifi_ssid \"&lt;your ssid>\"</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> wifi_password \"&lt;ssid password>\"</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  WiFi<span class=\"token punctuation\">.</span><span class=\"token function\">begin</span><span class=\"token punctuation\">(</span>wifi_ssid<span class=\"token punctuation\">,</span> wifi_password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>WiFi<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> WL_CONNECTED<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Serial<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  Serial<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Serial<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"WiFi connected\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Serial<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"IP address: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Serial<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>WiFi<span class=\"token punctuation\">.</span><span class=\"token function\">localIP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"2\">\n<li>read data from the temperature sensor</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;OneWire.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;DallasTemperature.h></span></span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> ONE_WIRE_BUS 2</span>\n\nOneWire <span class=\"token function\">oneWire</span><span class=\"token punctuation\">(</span>ONE_WIRE_BUS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nDallasTemperature <span class=\"token function\">sensors</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>oneWire<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  sensors<span class=\"token punctuation\">.</span><span class=\"token function\">requestTemperatures</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">float</span> tempC <span class=\"token operator\">=</span> sensors<span class=\"token punctuation\">.</span><span class=\"token function\">getTempCByIndex</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"3\">\n<li>push readings to MQTT broker</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;ESP8266WiFi.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;PubSubClient.h></span></span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> mqtt_server \"&lt;server ip or hostname>\"</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> mqtt_port \"&lt;server port>\"</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> mqtt_user \"&lt;user name>\"</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> mqtt_password \"&lt;user password>\"</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> temperature_topic \"temperature/home/basement\"</span>\n\nWiFiClient espClient<span class=\"token punctuation\">;</span>\nPubSubClient <span class=\"token function\">client</span><span class=\"token punctuation\">(</span>espClient<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  client<span class=\"token punctuation\">.</span><span class=\"token function\">setServer</span><span class=\"token punctuation\">(</span>mqtt_server<span class=\"token punctuation\">,</span> mqtt_port<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">reconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>client<span class=\"token punctuation\">.</span><span class=\"token function\">connected</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    Serial<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Attempting MQTT connection...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ESP8266BasementClient\"</span><span class=\"token punctuation\">,</span> mqtt_user<span class=\"token punctuation\">,</span> mqtt_password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      Serial<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"connected\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      Serial<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed, rc=\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      Serial<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">.</span><span class=\"token function\">state</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      Serial<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" try again in 5 seconds\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">loop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>client<span class=\"token punctuation\">.</span><span class=\"token function\">connected</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">reconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n  <span class=\"token punctuation\">}</span>\n  client<span class=\"token punctuation\">.</span><span class=\"token function\">loop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  client<span class=\"token punctuation\">.</span><span class=\"token function\">publish</span><span class=\"token punctuation\">(</span>temperature_topic<span class=\"token punctuation\">,</span> <span class=\"token string\">\"80.0\"</span><span class=\"token punctuation\">,</span> true<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Wait 30 seconds</span>\n  <span class=\"token function\">delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">30000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You can run above snippets independently or combine them together. At this point I need to say that it was so easy only thanks to these great libraries (as I have basically no experience in C language):</p>\n<p><a href=\"https://github.com/esp8266/Arduino/tree/master/libraries/ESP8266WiFi\">ESP8266WiFi</a></p>\n<p><a href=\"https://github.com/knolleary/pubsubclient\">PubSubClient</a></p>\n<p><a href=\"https://github.com/milesburton/Arduino-Temperature-Control-Library\">DallasTemperature</a></p>\n<h3>Nodejs</h3>\n<p>I wanted to have something very light on the back end and to be able to host it for free so I decided to accomplish my requirements using nodejs which will run on Heroku. Another reason to choose Nodejs was that I wanted to check it out as I heard a lot of good about it. </p>\n<p>Main responsibilities of the Nodejs application:</p>\n<ol>\n<li>expose REST endpoints to handle device registration, update and delete:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">app<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/device'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> deviceName <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>deviceName<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> deviceId   <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>deviceId<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> registrationId <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>registrationId<span class=\"token punctuation\">;</span>    \n\n    Device<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>deviceId <span class=\"token punctuation\">:</span> deviceId<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> devices<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>devices<span class=\"token punctuation\">.</span>length <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            Device<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n                deviceName<span class=\"token punctuation\">:</span> deviceName<span class=\"token punctuation\">,</span>\n                deviceId<span class=\"token punctuation\">:</span> deviceId<span class=\"token punctuation\">,</span>\n                registrationId<span class=\"token punctuation\">:</span> registrationId\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> device<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>            \n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>        \n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/device'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> deviceId   <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>deviceId<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> registrationId <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>registrationId<span class=\"token punctuation\">;</span>\n\n    Device<span class=\"token punctuation\">.</span><span class=\"token function\">findOneAndUpdate</span><span class=\"token punctuation\">(</span>\n        <span class=\"token punctuation\">{</span> deviceId<span class=\"token punctuation\">:</span> deviceId <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> \n        <span class=\"token punctuation\">{</span> registrationId<span class=\"token punctuation\">:</span> registrationId <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> \n        <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> device<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token keyword\">delete</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/device/:deviceId'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> deviceId   <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>deviceId<span class=\"token punctuation\">;</span>\n    Device<span class=\"token punctuation\">.</span><span class=\"token function\">findOneAndRemove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>deviceId <span class=\"token punctuation\">:</span> deviceId<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">sendStatus</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ol start=\"2\">\n<li>\n<p>expose WebSocket endpoint using <a href=\"https://www.npmjs.com/package/express-ws\">express-ws</a></p>\n</li>\n<li>\n<p>subscribe to MQTT topic and update <code class=\"language-text\">lastTemp</code> object with current temperature and notify registered devices if the temperature is above 80 degrees:</p>\n</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">mqttClient<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>topic<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'received message %s %s'</span><span class=\"token punctuation\">,</span> topic<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">)</span>\n    lastTemp<span class=\"token punctuation\">.</span>temperature <span class=\"token operator\">=</span> message<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    aWss<span class=\"token punctuation\">.</span>clients<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        client<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            topic<span class=\"token punctuation\">:</span> topic<span class=\"token punctuation\">,</span>\n            temperature<span class=\"token punctuation\">:</span> message<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>lastTemp<span class=\"token punctuation\">.</span>temperature<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">80.0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> message <span class=\"token operator\">=</span> <span class=\"token string\">'Warning temperature is very high '</span> <span class=\"token operator\">+</span> lastTemp<span class=\"token punctuation\">.</span>temperature <span class=\"token operator\">+</span> <span class=\"token string\">'°C'</span><span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">moment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">diff</span><span class=\"token punctuation\">(</span>lastUpdateDate<span class=\"token punctuation\">,</span> <span class=\"token string\">'minutes'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            gcm<span class=\"token punctuation\">.</span><span class=\"token function\">pushAll</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                lastUpdateDate <span class=\"token operator\">=</span> <span class=\"token function\">moment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>above was accomplished with <a href=\"https://www.npmjs.com/package/mqtt\">MQTT</a> and <a href=\"https://www.npmjs.com/package/fcm\">FCM</a> libraries. Documentation is very good even for Noob as I’m (in the case of Node.js) so no more explanation is required.</p>\n<h3>Android</h3>\n<p>For Android system, I created a simple widget which displays current temperature and is also able to receive messages from <a href=\"https://firebase.google.com/docs/cloud-messaging/\">\nFirebase Cloud Messaging</a> and display them as notifications. Because this is my first experience with Android SDK and I did all the research and implementation over the weekend I beat that there are better patterns for handling my requirements. Here are two screenshots of this application:</p>\n<ol>\n<li>widget</li>\n</ol>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin: 15px -30px !important max-width: 346px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 177.74566473988438%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"android_widget\"\n        title=\"\"\n        src=\"/static/android_widget-e9e73577e9a8e2aaa4f0b1e1eab4f702-7c0f2.png\"\n        srcset=\"/static/android_widget-e9e73577e9a8e2aaa4f0b1e1eab4f702-91e8b.png 175w,\n/static/android_widget-e9e73577e9a8e2aaa4f0b1e1eab4f702-7c0f2.png 346w\"\n        sizes=\"(max-width: 346px) 100vw, 346px\"\n      />\n    </span>\n  </span>\n  </p>\n<ol start=\"2\">\n<li>notification</li>\n</ol>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin: 15px -30px !important max-width: 346px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 177.74566473988438%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"android_notification\"\n        title=\"\"\n        src=\"/static/android_notification-661067bfd7d5360baed870f1284e362d-7c0f2.png\"\n        srcset=\"/static/android_notification-661067bfd7d5360baed870f1284e362d-91e8b.png 175w,\n/static/android_notification-661067bfd7d5360baed870f1284e362d-7c0f2.png 346w\"\n        sizes=\"(max-width: 346px) 100vw, 346px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>Integration with FCM was kind of tricky but <a href=\"https://firebase.google.com/docs/cloud-messaging/android/client\">“Set Up a Firebase Cloud Messaging Client App on Android”</a> article helped me a lot. It will take you step by step how to set up FCM client.</p>\n<h2>Future work</h2>\n<p>I will try to replace Nodejs application with application that use <a href=\"http://vertx.io/\">Vert.x</a> library.</p>","frontmatter":{"title":"Homemade central heating temperature monitoring","date":"December 15, 2016"}}},"pageContext":{"slug":"/2016-12-15-homemade-central-heating-temperature-monitoring/","previous":{"fields":{"slug":"/2016-11-02-watch-were-you-put-your-license-headers/"},"excerpt":"Recently when I was playing with creating  Docker  images I came across really strange error during creation of a container that doesn’t say…","frontmatter":{"title":"Watch were you put your license headers","date":"November 2, 2016"}},"next":{"fields":{"slug":"/2017-05-28-kotlin-aws-lambda-serverless-framework/"},"excerpt":"Some time ago I came across the following tweet. There were two things that took my attention - kotlin and Rekognition. First one is a “new…","frontmatter":{"title":"Kotlin + AWS Lambda + Serverless Framework","date":"May 28, 2017"}}}}
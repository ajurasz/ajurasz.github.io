<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/1.714e789c58edc4d97d4f.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.0.31"/><style data-styled="deuHhw dVlzdf FSiJo kfPuqG hyXYOK itGeow eXcfSN iWIxoV kGCCTl fGSVd gGIelI kVSOZg KDfzM gzoEET deWstv dgtalV ZNTDw cRzLhO jLNeCQ eBuswQ ukmsj" data-styled-version="4.3.1">
/* sc-component-id: sc-global-3325714496 */
@import url("https://fonts.googleapis.com/css?family=Roboto:400,700"); html{line-height:1.15;-webkit-text-size-adjust:100%;} body{margin:0;} h1{font-size:2em;margin:0.67em 0;} hr{box-sizing:content-box;height:0;overflow:visible;} pre{font-family:monospace,monospace;font-size:1em;} a{background-color:transparent;} abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;} b,strong{font-weight:bolder;} code,kbd,samp{font-family:monospace,monospace;font-size:1em;} small{font-size:80%;} sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;} sub{bottom:-0.25em;} sup{top:-0.5em;} img{border-style:none;} button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;} button,input{overflow:visible;} button,select{text-transform:none;} button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button;} button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;} button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText;} fieldset{padding:0.35em 0.75em 0.625em;} legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;} progress{vertical-align:baseline;} textarea{overflow:auto;} [type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;} [type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto;} [type="search"]{-webkit-appearance:textfield;outline-offset:-2px;} [type="search"]::-webkit-search-decoration{-webkit-appearance:none;} ::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;} details{display:block;} summary{display:list-item;} template{display:none;} [hidden]{display:none;} *,*:before,*:after{box-sizing:inherit;} html{font-size:62.5%;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;box-sizing:border-box;} body{background:#f9fafc;font-family:'Open Sans',sans-serif;line-height:1.5;padding:50px 0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;} img{max-width:100%;} .gatsby-highlight{border-bottom:1px solid #e0e6ed;border-top:1px solid #e0e6ed;margin:15px -100px;padding:0;} .gatsby-highlight pre[class*="language-"]{margin:0;padding:25px 100px;} pre[class*="language-"]{background:rgba(245,245,245,1);color:rgb(65,76,94);} @media only screen and (max-width:870px){.gatsby-highlight{margin:15px -15px;}.gatsby-highlight pre[class*="language-"]{padding:25px;}}
/* sc-component-id: sc-bdVaJa */
.deuHhw{margin:0 auto;max-width:1080px;}
/* sc-component-id: sc-htpNat */
.itGeow{margin-top:15px;text-align:center;}
/* sc-component-id: sc-bxivhb */
.eXcfSN{border:1px solid #bfc8d2;border-radius:15px;color:#3e465b;display:inline-block;margin:5px;padding:5px 10px;-webkit-text-decoration:none;text-decoration:none;} .eXcfSN svg{display:inline-block;height:20px;stroke:#6e849c;vertical-align:middle;width:20px;} .eXcfSN:hover{border-color:#3e465b;}
/* sc-component-id: sc-ifAKCX */
.FSiJo{color:#3e465b;font-size:35px;line-height:1.5;margin:0;padding:0 30px;text-align:center;}
/* sc-component-id: sc-EHOje */
.kVSOZg{color:#666d71;display:block;font-size:1.6em;margin:50px 0 0 0;text-align:center;}
/* sc-component-id: sc-bZQynM */
.hyXYOK{color:#666d71;display:block;font-size:1.6em;margin:50px 0 0 0;text-align:center;margin:0;}
/* sc-component-id: sc-gzVnrw */
.kfPuqG{color:#3498db;-webkit-text-decoration:none;text-decoration:none;}
/* sc-component-id: sc-htoDjs */
.dVlzdf{margin:0 auto;max-width:650px;padding:0 50px 50px;text-align:center;}
/* sc-component-id: sc-dnqmqq */
.iWIxoV{background:#fff;border:1px solid #e0e6ed;box-shadow:0 1px 5px rgba(0,0,0,0.05);margin-bottom:30px;padding:75px 100px;} @media only screen and (max-width:870px){.iWIxoV{border-left:none;border-right:none;padding:75px 15px;}}
/* sc-component-id: sc-iwsKbI */
.gzoEET{margin-top:50px;text-align:center;}
/* sc-component-id: sc-gZMcBi */
.deWstv{border:1px solid #bfc8d2;border-radius:25px;color:#3e465b;display:inline-block;font-size:10px;font-weight:700;margin:0 10px;padding:5px 15px;-webkit-text-decoration:none;text-decoration:none;text-transform:uppercase;} .deWstv:hover{border-color:#000;}
/* sc-component-id: sc-VigVT */
.kGCCTl{text-align:center;}
/* sc-component-id: sc-jTzLTM */
.fGSVd{color:#3e465b;-webkit-text-decoration:none;text-decoration:none;} .fGSVd:hover{color:#3498db;}
/* sc-component-id: sc-fjdhpX */
.gGIelI{color:#666d71;display:block;font-size:1.6em;margin:0;text-align:center;}
/* sc-component-id: sc-jzJRlG */
.KDfzM{color:#666d71;display:inline-block;font-size:14px;margin-top:50px;-webkit-text-decoration:none;text-decoration:none;} .KDfzM:hover{color:#3498db;}
/* sc-component-id: sc-cSHVUG */
.ZNTDw{color:#65738c;font-size:16px;} .ZNTDw a{color:#3498db;font-weight:700;-webkit-text-decoration:none;text-decoration:none;} .ZNTDw a:hover{-webkit-text-decoration:underline;text-decoration:underline;} .ZNTDw h1{color:#3e465b;font-size:30px;font-weight:700;line-height:1.5;margin:25px 50px 15px;} .ZNTDw h2{color:#3e465b;font-size:22px;font-weight:700;line-height:1.5;margin:25px 50px 15px;} .ZNTDw h3{color:#3e465b;font-size:17px;font-weight:700;line-height:1.5;margin:25px 50px 15px;} .ZNTDw h4{color:#3e465b;font-weight:700;line-height:1.5;margin:25px 50px 15px;} .ZNTDw h5,.ZNTDw h6{color:#3e465b;font-weight:700;line-height:1.5;margin:25px 50px 15px;} .ZNTDw p{line-height:1.7;margin:15px 50px;} .ZNTDw blockquote{border-left:5px solid #e0e6ed;line-height:1.7;margin:15px 50px 15px 75px;padding:10px 10px 10px 15px;} .ZNTDw blockquote p{margin:0;} .ZNTDw ul,.ZNTDw ol{line-height:1.7;margin:15px 0;padding:0 50px 0 100px;} .ZNTDw ul p,.ZNTDw ol p,.ZNTDw ul ul,.ZNTDw ol ul,.ZNTDw ul ol,.ZNTDw ol ol{margin:0;} .ZNTDw ul ul,.ZNTDw ol ul,.ZNTDw ul ol,.ZNTDw ol ol{padding:0 0 0 30px;} .ZNTDw img{margin:15px 0;}
/* sc-component-id: sc-kAzzGY */
.dgtalV h1{color:#3e465b;font-size:35px;line-height:1.5;margin:0;padding:0 30px;text-align:center;} .dgtalV p{color:#666d71;display:block;font-size:1.6em;margin:0;text-align:center;} .dgtalV span{background:#9c9da3;display:block;margin:50px auto;height:1px;width:150px;}
/* sc-component-id: sc-chPdSV */
.ukmsj{margin-top:50px;text-align:center;}
/* sc-component-id: sc-kgoBCf */
.jLNeCQ{color:#3e465b;font-size:22px;font-weight:700;line-height:1.5;margin:25px 50px 15px;}
/* sc-component-id: sc-kGXeez */
.cRzLhO{margin-top:50px;text-align:center;}
/* sc-component-id: sc-kpOJdX */
.eBuswQ{border:1px solid #bfc8d2;border-radius:15px;display:inline-block;margin:5px;padding:5px 15px;-webkit-text-decoration:none;text-decoration:none;} .eBuswQ svg{display:inline-block;height:20px;stroke:#6e849c;vertical-align:middle;width:20px;} .eBuswQ:hover{border-color:#3e465b;}</style><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#3498db"/><title data-react-helmet="true">Bluetooth scanner on Raspberry Pi | Arek Jurasz</title><meta data-react-helmet="true" name="description" content="Dev Blog | Software Engineer"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-e72754999b55d36dd31c.js"/><link as="script" rel="preload" href="/app-7680c8ae95fa8ed3e372.js"/><link as="script" rel="preload" href="/8-58ff8726c03efc64fed6.js"/><link as="script" rel="preload" href="/1-aa28afa334b9d14036e0.js"/><link as="script" rel="preload" href="/0-b12e9dd51b1da10d38fa.js"/><link as="script" rel="preload" href="/webpack-runtime-8b7b53a9b0932e3c82df.js"/><link rel="preload" href="/static/d/517/path---2015-11-16-bluetooth-scanner-on-raspberry-pi-8-f-6-c35-JEFk2oUsl550hNddeFaBxOuIAI.json" as="fetch" crossOrigin="use-credentials"/><link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAABILAAASCwAAAAAAAAAAAADbmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmjX/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uaNf/bmTP/2pUq/9uZM//bmjT/25o1/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25o1/9ybN//alSv/25o1/+KtXP/bmDL/2pYt/9qVK//cmzb/25o1/9uZM//bmTP/25kz/9uZM//bmTP/25o0/9qVK//YjyD/36RJ/+W1bf/25s//3J07/+CoUv/irFv/2JAh/9mUKP/bmTT/25kz/9uZM//bmTP/25k0/9qVLP/hqVT/8tq3///////pwob/8tq1/+OvYf/ksmb///////Xjyf/jsWX/2pYt/9uZM//bmTP/3Js2/9mTJ//uz6H///////DUq//eo0j/1owZ/+7Nnf/tzJr/140b/9ydPP/syJP///////ThxP/aliz/25o0/9uaNf/alSv/57t5//nv4P/25s//68eR/9ybOP/ltGv/896//9qWL//pwIP/9eLG//nw4//rx5H/2pYu/9uaNP/bmTP/25o0/9mTKP/blzH/57t4//rx5f/ty5n/3Js3//Xjyf/pwYX/+/Tq/+rDif/cnDn/2ZIl/9uZNP/bmTP/25kz/9uZM//bmjX/25kz/9iRJP/ZlCr/3Z9A/9mUKf/z38D/5bRs/9iRJf/YkST/25gx/9yaNv/bmTP/25kz/9uZM//bmTP/25kz/9uZM//cmjb/25o0/9uYMP/bmDH/3Z4//9ybOf/bmDH/3Js3/9uZNP/bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTT/25kz/9uYMP/bmDH/25k0/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTT/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/25kz/9uZM//bmTP/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div><section class="sc-bdVaJa deuHhw"><header class="sc-htoDjs dVlzdf"><h1 class="sc-ifAKCX FSiJo"><a class="sc-gzVnrw kfPuqG" href="/">Arek Jurasz</a></h1><p class="sc-EHOje sc-bZQynM hyXYOK">Software Engineer</p><div class="sc-htpNat itGeow"><a href="https://twitter.com/arekjurasz" target="_blank" rel="noopener" class="sc-bxivhb eXcfSN"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a><a href="https://github.com/ajurasz" target="_blank" rel="noopener" class="sc-bxivhb eXcfSN"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a href="https://www.linkedin.com/in/arkadiusz-jurasz/" target="_blank" rel="noopener" class="sc-bxivhb eXcfSN"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a><a href="https://ajurasz.github.io/rss.xml" target="_blank" rel="noopener" class="sc-bxivhb eXcfSN"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></div></header></section><section class="sc-bdVaJa deuHhw"><div class="sc-dnqmqq iWIxoV"><div class="sc-kAzzGY dgtalV"><h1>Bluetooth scanner on Raspberry Pi</h1><p>November 16, 2015</p><span></span></div><article class="sc-cSHVUG ZNTDw"><div><p>Do you want to know what bluetooth devices are in the range of your raspberry Pi unit and then act accordingly? Now it’s easier than ever before because with version 0.1.3 <a href="https://github.com/rhiot/rhiot/blob/master/docs/readme.md">rhiot</a> comes with bunch of new IoT components and one of them is <a href="https://rhiot.gitbooks.io/rhiotdocumentation/content/gateway/camel_components/camel_bluetooth_component.html">Camel Bluetooth component</a> which will allow you to list bluetooth devices working in surrounding area. There is also possibility to list services of given device if you want to know how to interact with it.</p>
<!-- end -->
<p><a href="https://rhiot.gitbooks.io/rhiotdocumentation/content/gateway/camel_components/camel_bluetooth_component.html">Camel Bluetooth component</a> is a wrapper around <a href="http://www.bluecove.org">bluecove</a> library. To work properly it require OS packages for handling bluetooth devices. By default it supports Ubuntu and Raspbian by installing <code class="language-text">libbluetooth-dev</code> and <code class="language-text">blueman</code> packages. With some configuration you can run it on OSX as well, please refer to <a href="https://rhiot.gitbooks.io/rhiotdocumentation/content/gateway/camel_components/camel_bluetooth_component.html">Installation section</a>. You will also need to set dedicated installer (<code class="language-text">io.rhiot.utils.install.BrewInstaller</code>) when working with OSX.</p>
<h2>Create scanning endpoint</h2>
<p>Following example demonstrate how easy it is to expose REST endpoint which will trigger bluetooth scanner. This code can be run on both pc and raspberry pi:</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token function">restConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">"netty4-http"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">host</span><span class="token punctuation">(</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">port</span><span class="token punctuation">(</span><span class="token number">8081</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">bindingMode</span><span class="token punctuation">(</span>RestBindingMode<span class="token punctuation">.</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">rest</span><span class="token punctuation">(</span><span class="token string">"/api/devices"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">"bluetooth://scan?serviceDiscovery=true"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>In above snipped we are doing two things, configuring <a href="http://camel.apache.org/netty4.html">netty4 component</a> by setting host, port and binding mode. With binding mode set to <code class="language-text">json</code> there is automatic conversion of <code class="language-text">json</code> content to and from POJOs for all incoming and outgoing messages. Then <code class="language-text">GET</code> endpoint was created with the <code class="language-text">/api/devices</code> URI.</p>
<p>Run application:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">java -jar target/scanner-pc-1.0-SNAPSHOT.jar</code></pre></div>
<p>then</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> http://localhost:8081/api/devices</code></pre></div>
<p>and formatted response should look like this:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"arek"</span><span class="token punctuation">,</span>
    <span class="token property">"address"</span><span class="token operator">:</span> <span class="token string">"44D4E0AAA2B1"</span><span class="token punctuation">,</span>
    <span class="token property">"bluetoothServices"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Advanced Audio"</span><span class="token punctuation">,</span>
        <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"btl2cap://44D4E0AAA2B1:0019;authenticate=false;encrypt=false;master=false"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"OBEX Object Push"</span><span class="token punctuation">,</span>
        <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"btgoep://44D4E0AAA2B1:12;authenticate=false;encrypt=false;master=false"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Headset Gateway"</span><span class="token punctuation">,</span>
        <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"btspp://44D4E0AAA2B1:2;authenticate=false;encrypt=false;master=false"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Handsfree Gateway"</span><span class="token punctuation">,</span>
        <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"btspp://44D4E0AAA2B1:3;authenticate=false;encrypt=false;master=false"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"OBEX Phonebook Access Server"</span><span class="token punctuation">,</span>
        <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"btgoep://44D4E0AAA2B1:19;authenticate=false;encrypt=false;master=false"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"AV Remote Control Target"</span><span class="token punctuation">,</span>
        <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"btl2cap://44D4E0AAA2B1:0017;authenticate=false;encrypt=false;master=false"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"AAS"</span><span class="token punctuation">,</span>
        <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"btspp://44D4E0AAA2B1:4;authenticate=false;encrypt=false;master=false"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Android Network Access Point"</span><span class="token punctuation">,</span>
        <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"btl2cap://44D4E0AAA2B1:000f;authenticate=false;encrypt=false;master=false"</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span></code></pre></div>
<h2>Bluetooth scanner on Raspberry Pi</h2>
<p>Let’s get to the point and see example running on Raspberry Pi. Consider following scenario:</p>
<ol>
<li>Each time scanning is triggered blink yellow LED to indicate that application is running.</li>
<li>Search device by it’s name.</li>
<li>If device if found turn on geen LED</li>
<li>If device is not found turn red LED</li>
</ol>
<p>Note: for 3 and 4 only one LED can be on.</p>
<h4>Wiring</h4>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/static/bluetooth-scanner-witing-3b3ae090a9f39281fe6e6b20af8d57c1-cd76f.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; margin: 15px -30px !important max-width: 651px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 105.3763440860215%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAUDAgT/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgD/2gAMAwEAAhADEAAAAbnm1mhWZncxiZtBr//EAB4QAAEEAQUAAAAAAAAAAAAAAAMBAhESABMUMTIz/9oACAEBAAEFAn9ZWWcGfQe7TAuuwyXHopIPP//EABcRAQEBAQAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8B6GJF/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEQEf/aAAgBAgEBPwHYxH//xAAZEAADAQEBAAAAAAAAAAAAAAAAARExEDL/2gAIAQEABj8CN43KeCpQaw3n/8QAHBABAAMAAgMAAAAAAAAAAAAAAQARIUFRcYGR/9oACAEBAAE/IVTZ3H2a3AZ6KlbpPcE6jqb7wbl2lab5hA0UXP/aAAwDAQACAAMAAAAQI9dC/8QAGBEBAQEBAQAAAAAAAAAAAAAAAQAhMRH/2gAIAQMBAT8Qexh92JduC//EABgRAQEAAwAAAAAAAAAAAAAAAAEAESEx/9oACAECAQE/EEDuHMRbi//EAB0QAQEBAQABBQAAAAAAAAAAAAERACExQWGRscH/2gAIAQEAAT8QUpiGE9ynlkipWvnJ2JI+qsMq3BRIo/G60CdX83c6oAsjgZQpU88dw52HKv3v/9k='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Posts per blog"
        title=""
        src="/static/bluetooth-scanner-witing-3b3ae090a9f39281fe6e6b20af8d57c1-cd76f.jpg"
        srcset="/static/bluetooth-scanner-witing-3b3ae090a9f39281fe6e6b20af8d57c1-a8a55.jpg 175w,
/static/bluetooth-scanner-witing-3b3ae090a9f39281fe6e6b20af8d57c1-ffe5f.jpg 350w,
/static/bluetooth-scanner-witing-3b3ae090a9f39281fe6e6b20af8d57c1-cd76f.jpg 651w"
        sizes="(max-width: 651px) 100vw, 651px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>To assemble this schematic you will require:</p>
<ul>
<li>1 Raspberry Pi B+ (or 2)</li>
<li>1 Breadbord</li>
<li>3 LEDs</li>
<li>3 220 ohms resistors</li>
<li>7 Wires</li>
</ul>
<p>And here is the code to run on Raspberry Pi:</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ScannerRoute</span> <span class="token keyword">extends</span> <span class="token class-name">RouteBuilder</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
        <span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"bluetooth://scan?consumer.delay=1000"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">"pi4j-gpio://1?mode=DIGITAL_OUTPUT&amp;state=LOW&amp;action=BLINK"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">choice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">when</span><span class="token punctuation">(</span><span class="token function">deviceWithName</span><span class="token punctuation">(</span>DEVICE_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>p <span class="token operator">-</span><span class="token operator">></span> p<span class="token punctuation">.</span><span class="token function">getIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span>DEVICE_FOUND<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">otherwise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>p <span class="token operator">-</span><span class="token operator">></span> p<span class="token punctuation">.</span><span class="token function">getIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span>DEVICE_NOT_FOUND<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">multicast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">"direct:green"</span><span class="token punctuation">,</span> <span class="token string">"direct:red"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"direct:green"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>exchange <span class="token operator">-</span><span class="token operator">></span> <span class="token function">checkHeaderAndSetAction</span><span class="token punctuation">(</span>DEVICE_FOUND<span class="token punctuation">,</span> exchange<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">"pi4j-gpio://2?mode=DIGITAL_OUTPUT&amp;state=LOW"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"direct:red"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>exchange <span class="token operator">-</span><span class="token operator">></span> <span class="token function">checkHeaderAndSetAction</span><span class="token punctuation">(</span>DEVICE_NOT_FOUND<span class="token punctuation">,</span> exchange<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">"pi4j-gpio://3?mode=DIGITAL_OUTPUT&amp;state=LOW"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">checkHeaderAndSetAction</span><span class="token punctuation">(</span>String headerKey<span class="token punctuation">,</span> Exchange exchange<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>exchange<span class="token punctuation">.</span><span class="token function">getIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span>headerKey<span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            exchange<span class="token punctuation">.</span><span class="token function">getIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span>Pi4jConstants<span class="token punctuation">.</span>CAMEL_RBPI_PIN_ACTION<span class="token punctuation">,</span> GPIOAction<span class="token punctuation">.</span>HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            exchange<span class="token punctuation">.</span><span class="token function">getIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span>Pi4jConstants<span class="token punctuation">.</span>CAMEL_RBPI_PIN_ACTION<span class="token punctuation">,</span> GPIOAction<span class="token punctuation">.</span>LOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>With this route few <a href="http://camel.apache.org/eip.html">EIP</a> were used but I won’t explain them here as it’s out of the scope of this post. The flow is following:</p>
<ol>
<li>Consume results of a scanning.</li>
<li>Blink yellow LED.</li>
<li>Using predefined <code class="language-text">Predicate</code> check if we found device with given name.</li>
<li>Add extra header to message if device was found.</li>
<li>Add extra header to message if device was not found.</li>
<li>Route message to multiple endpoints.</li>
<li>Examine message headers and depending on what you have found change pin action.</li>
</ol>
<h4>Final result</h4>
<div>
          <div
            class="gatsby-resp-iframe-wrapper"
            style="padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem"
          >
            <iframe src="https://www.youtube.com/embed/pmYk7Yg13Lg?t=35s" frameborder="0" allowfullscreen style="
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          "></iframe>
          </div>
          </div>
<p>Source code can be found <a href="https://github.com/ajurasz/blog-samples">here</a>.</p>
<p>To build all modules you just need to execute from project directory</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">./mvnw clean <span class="token function">install</span></code></pre></div>
<p>notice that I’m writing maven pom in groovy so if you want you can convert <code class="language-text">pom.groovy</code> to <code class="language-text">pom.xml</code> with following command</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">./mvnw io.takari.polyglot:polyglot-translate-plugin:translate</code></pre></div></div></article><div class="sc-kGXeez cRzLhO"><h2 class="sc-kgoBCf jLNeCQ">Share This Post</h2><a href="https://www.facebook.com/sharer/sharer.php?u=" target="_blank" aria-label="Share on Facebook" rel="noopener" class="sc-kpOJdX eBuswQ"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg></a><a href="https://twitter.com/intent/tweet?text=Bluetooth%20scanner%20on%20Raspberry%20Pi&amp;url=" target="_blank" aria-label="Share on Twitter" rel="noopener" class="sc-kpOJdX eBuswQ"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=&amp;title=Bluetooth%20scanner%20on%20Raspberry%20Pi" target="_blank" aria-label="Share on LinkedIn" rel="noopener" class="sc-kpOJdX eBuswQ"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a><a href="mailto:?subject=Bluetooth%20scanner%20on%20Raspberry%20Pi&amp;body=" aria-label="Share by Email" rel="noopener" class="sc-kpOJdX eBuswQ"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a></div></div><div class="sc-chPdSV ukmsj"><a rel="next" class="sc-gZMcBi deWstv" href="/2016-11-02-watch-were-you-put-your-license-headers/">Watch were you put your license headers<!-- --> →</a></div></section></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-70225806-1', 'auto', {});
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"2015-11-16-bluetooth-scanner-on-raspberry-pi-8f6","path":"/2015-11-16-bluetooth-scanner-on-raspberry-pi/"};window.dataPath="517/path---2015-11-16-bluetooth-scanner-on-raspberry-pi-8-f-6-c35-JEFk2oUsl550hNddeFaBxOuIAI";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-7680c8ae95fa8ed3e372.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-70fa0028ee7496e8897a.js"],"component---src-templates-index-js":["/component---src-templates-index-js-06c9c30cff328926f332.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-e72754999b55d36dd31c.js"],"component---src-pages-404-js":["/component---src-pages-404-js-73aa4ee436ca34094f3e.js"]};/*]]>*/</script><script src="/webpack-runtime-8b7b53a9b0932e3c82df.js" async=""></script><script src="/0-b12e9dd51b1da10d38fa.js" async=""></script><script src="/1-aa28afa334b9d14036e0.js" async=""></script><script src="/8-58ff8726c03efc64fed6.js" async=""></script><script src="/app-7680c8ae95fa8ed3e372.js" async=""></script><script src="/component---src-templates-blog-post-js-e72754999b55d36dd31c.js" async=""></script></body></html>